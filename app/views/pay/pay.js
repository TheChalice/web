/** * Created by sorcerer on 16/10/9. */angular.module('console.pay', [        {            files: [                'views/pay/pay.css'            ]        }    ])    .controller('payCtrl', ['account','$http', '$state', 'Tip', '$scope', 'recharge', '$rootScope',        function (account,$http, $state, Tip, $scope, recharge, $rootScope) {            $scope.payfor = {                hzf: true,                yhq: false            }            $scope.payerr = {                num: false            }            $scope.amount = '';            $scope.payforfun = function (num) {                if (num == 1) {                    $scope.payfor.hzf = true;                    $scope.payfor.yhq = false;                } else {                    $scope.payfor.yhq = true;                    $scope.payfor.hzf = false;                }            }            var r = /^\d+$/;            $scope.$watch('amount', function (n, o) {                if (n === o) {                    return                }                //console.log(n);                if (r.test(n)) {                    recharge.create({namespace: $rootScope.namespace, amount: n}, function (res) {                        $('#pack').val(res.payloads[0].value);                        $scope.payerr.num = true;                    });                } else {                    $scope.payerr.num = false                }            })            $scope.dopay= function () {                Tip.open('充值提示', '充值完成前请不要关闭此窗口', '确定', '充值完成').then(function () {                    account.get({}, function (data) {                        if (data.purchased) {                            $state.go('console.dashboard')                        }else {                            $state.go('console.plan')                        }                    })                })            }                        //recharge.create({namespace: $rootScope.namespace, amount: 11}, function (res) {            //    console.log('lelelelelelele',res.payloads[0].value);            //    $('#pack').val(res.payloads[0].value);            //});            //$scope.dopay = function () {                //$http.post('http://datafoundry.recharge.app.dataos.io/charge/v1/recharge',                //    {namespace: $rootScope.namespace,                //        amount: $scope.amount},                //    {'Content-Type':'application/x-www-form-urlencoded'}).success(function(data){                //    $scope.industries = data;                //});                //recharge.create({namespace: $rootScope.namespace, amount: $scope.amount}, function (res) {                //    console.log('lelelelelelele',res.payloads[0].value);                //    //var obj = {};                //    //obj[res.payloads[0].name]=res.payloads[0].value;                //    //payloads                //    //console.log(obj);                //    //var xml_value=data.reqSignMsg;                //                //    $('#pack').val(res.payloads[0].value);                //    //$http({                //    //    method:'post',                //    //    url:res.aiurl,                //    //    headers: {'content-type':'application/x-www-form-urlencoded'}  //请求头里会添加Authorization属性为'code_bunny'                //    //}).success(function(data,status,headers,config){                //    //    console.log(data);                //    //}).error(function(err,status,headers,config){                //    //    console.log(err);                //    //});                //    //'content-type':'text/plain'                //                //    //$http.get(res.aiurl, obj,{}).success(function (data) {                //    //                //    //    $('#pack').val(xml_value);                //    //    Tip.open('充值提示', '充值完成前请不要关闭此窗口', '确定', '充值完成').then(function () {                //    //        //$state.go('console.dashboard')                //    //                //    //                //    //        //account.get({}, function (data) {                //    //        //    if (data.purchased) {                //    //        //        $state.go('console.dashboard')                //    //        //    }else {                //    //        //        $state.go('console.plan')                //    //        //    }                //    //        //})                //    //    })                //    //});                //                //                //});            //}        }]);